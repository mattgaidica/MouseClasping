function detectClasps(videoFile)
nFrames = 3;
padFactor = 3;
diskSize = 5;

videoFileReader = vision.VideoFileReader(videoFile);
f1_shapeInserter = vision.ShapeInserter('BorderColor','Custom','CustomBorderColor',[0 0 1]);
f2_shapeInserter = vision.ShapeInserter('BorderColor','Custom','CustomBorderColor',[0 1 0]);
hblob = vision.BlobAnalysis('AreaOutputPort',true,...
    'CentroidOutputPort',true,... 
    'BoundingBoxOutputPort',true);

% circle active zone
frame = step(videoFileReader);
h = figure;
imshow(frame);
activeRect = round(getPosition(imrect));
close(h);

f1_thresholds = getThresholds(videoFile,nFrames,padFactor);
f2_thresholds = getThresholds(videoFile,nFrames,padFactor);

while ~isDone(videoFileReader)
  f1_mask = claspMask(frame,thresholds,diskSize);
  [area,centroid,bbox] = step(hblob,mask);
  
  [areaVal,areaKey] = max(area);
                                        
  out = step(shapeInserter,frame,bbox(areaKey,:));
  step(videoPlayer,out);
end

frame = step(videoFileReader);
hsvFrame = rgb2hsv(frame);

end

function mask=claspMask(frame,thresholds,diskSize)
sedisk = strel('disk',diskSize);
hsvFrame = rgb2hsv(frame);
mask = HSVthreshold(hsvFrame,thresholds);
mask = imopen(mask,sedisk);
mask = imfill(mask,'holes');
end

function thresholds=getThresholds(videoFile,nFrames,padFactor)
hsvBounds = getHsvBounds(videoFile,nFrames);
thresholds = [
    mean(hsvBounds{1}), std(hsvBounds{1}) * padFactor...
    mean(hsvBounds{2})-(std(hsvBounds{2})*padFactor), mean(hsvBounds{2})+(std(hsvBounds{2})*padFactor)...
    mean(hsvBounds{3})-(std(hsvBounds{3})*padFactor), mean(hsvBounds{3})+(std(hsvBounds{3})*padFactor)...
];
end